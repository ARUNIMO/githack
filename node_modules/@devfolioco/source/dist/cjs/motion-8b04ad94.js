"use strict";var t=require("./motion-proxy-748ce165.js"),n=require("react");function o(t,n,o,i){return t.addEventListener(n,o,i),function(){return t.removeEventListener(n,o,i)}}function i(t,i,e,r){n.useEffect((function(){var n=t.current;if(e&&n)return o(n,i,e,r)}),[t,i,e,r])}function e(t){return"undefined"!=typeof PointerEvent&&t instanceof PointerEvent?!("mouse"!==t.pointerType):t instanceof MouseEvent}function r(t){return!!t.touches}var a={pageX:0,pageY:0};function s(t,n){void 0===n&&(n="page");var o=t.touches[0]||t.changedTouches[0]||a;return{x:o[n+"X"],y:o[n+"Y"]}}function u(t,n){return void 0===n&&(n="page"),{x:t[n+"X"],y:t[n+"Y"]}}function l(t,n){return void 0===n&&(n="page"),{point:r(t)?s(t,n):u(t,n)}}function c(t){return l(t,"client")}var p=function(t,n){void 0===n&&(n=!1);var o,i=function(n){return t(n,l(n))};return n?(o=i,function(t){var n=t instanceof MouseEvent;(!n||n&&0===t.button)&&o(t)}):i},v="undefined"!=typeof window,m={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},f={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function d(t){return v&&null===window.onpointerdown?t:v&&null===window.ontouchstart?f[t]:v&&null===window.onmousedown?m[t]:t}function g(t,n,i,e){return o(t,d(n),p(i,"pointerdown"===n),e)}function h(t,n,o,e){return i(t,d(n),o&&p(o,"pointerdown"===n),e)}var x=function(){function n(n,o,i){var a=this,s=(void 0===i?{}:i).transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(a.lastMoveEvent&&a.lastMoveEventInfo){var n=E(a.lastMoveEventInfo,a.history),o=null!==a.startEvent,i=t.distance(n.offset,{x:0,y:0})>=3;if(o||i){var e=n.point,r=t.getFrameData().timestamp;a.history.push(t.__assign(t.__assign({},e),{timestamp:r}));var s=a.handlers,u=s.onStart,l=s.onMove;o||(u&&u(a.lastMoveEvent,n),a.startEvent=a.lastMoveEvent),l&&l(a.lastMoveEvent,n)}}},this.handlePointerMove=function(n,o){a.lastMoveEvent=n,a.lastMoveEventInfo=y(o,a.transformPagePoint),e(n)&&0===n.buttons?a.handlePointerUp(n,o):t.sync.update(a.updatePoint,!0)},this.handlePointerUp=function(t,n){a.end();var o=a.handlers.onEnd;if(o&&a.startEvent){var i=E(y(n,a.transformPagePoint),a.history);o&&o(t,i)}},!(r(n)&&n.touches.length>1)){this.handlers=o,this.transformPagePoint=s;var u=y(l(n),this.transformPagePoint),c=u.point,p=t.getFrameData().timestamp;this.history=[t.__assign(t.__assign({},c),{timestamp:p})];var v=o.onSessionStart;v&&v(n,E(u,this.history)),this.removeListeners=t.pipe(g(window,"pointermove",this.handlePointerMove),g(window,"pointerup",this.handlePointerUp),g(window,"pointercancel",this.handlePointerUp))}}return n.prototype.updateHandlers=function(t){this.handlers=t},n.prototype.end=function(){this.removeListeners&&this.removeListeners(),t.cancelSync.update(this.updatePoint)},n}();function y(t,n){return n?{point:n(t.point)}:t}function A(t,n){return{x:t.x-n.x,y:t.y-n.y}}function E(t,n){var o=t.point;return{point:o,delta:A(o,M(n)),offset:A(o,P(n)),velocity:T(n,.1)}}function P(t){return t[0]}function M(t){return t[t.length-1]}function T(n,o){if(n.length<2)return{x:0,y:0};for(var i=n.length-1,e=null,r=M(n);i>=0&&(e=n[i],!(r.timestamp-e.timestamp>t.secondsToMilliseconds(o)));)i--;if(!e)return{x:0,y:0};var a=(r.timestamp-e.timestamp)/1e3;if(0===a)return{x:0,y:0};var s={x:(r.x-e.x)/a,y:(r.y-e.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function C(t){var n=null;return function(){return null===n&&(n=t,function(){n=null})}}var w=C("dragHorizontal"),D=C("dragVertical");function S(t){var n=!1;if("y"===t)n=D();else if("x"===t)n=w();else{var o=w(),i=D();o&&i?n=function(){o(),i()}:(o&&o(),i&&i())}return n}function L(n,o,i){var e=o.min,r=o.max;return void 0!==e&&n<e?n=i?t.mix(e,n,i.min):Math.max(n,e):void 0!==r&&n>r&&(n=i?t.mix(r,n,i.max):Math.min(n,r)),n}function _(t,n,o){return{min:void 0!==n?t.min+n:void 0,max:void 0!==o?t.max+o-(t.max-t.min):void 0}}function b(n,o){var i,e=o.min-n.min,r=o.max-n.max;return o.max-o.min<n.max-n.min&&(e=(i=t.__read([r,e],2))[0],r=i[1]),{min:n.min+e,max:n.min+r}}function B(t,n,o){return{min:k(t,n),max:k(t,o)}}function k(t,n){var o;return"number"==typeof t?t:null!==(o=t[n])&&void 0!==o?o:0}var R,V=new WeakMap,j=function(){function n(n){var o=n.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=t.axisBox(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=o,this.visualElement.enableLayoutProjection(),V.set(o,this)}return n.prototype.start=function(n,o){var i=this,e=void 0===o?{}:o,r=e.snapToCursor,a=void 0!==r&&r,s=e.cursorProgress;a&&this.snapToCursor(n);var u=this.props.transformPagePoint;this.panSession=new x(n,{onSessionStart:function(){i.stopMotion()},onStart:function(n,o){var e,r,a,u=i.props,l=u.drag,p=u.dragPropagation;if(!l||p||(i.openGlobalLock&&i.openGlobalLock(),i.openGlobalLock=S(l),i.openGlobalLock)){i.prepareBoundingBox(),i.visualElement.lockProjectionTarget(),i.resolveDragConstraints();var v=c(n).point;t.eachAxis((function(n){var o=i.visualElement.projection.target[n],e=o.min,r=o.max;i.cursorProgress[n]=s?s[n]:t.progress(e,r,v[n]);var a=i.getAxisMotionValue(n);a&&(i.originPoint[n]=a.get())})),i.isDragging=!0,i.currentDirection=null,null===(r=(e=i.props).onDragStart)||void 0===r||r.call(e,n,o),null===(a=i.visualElement.animationState)||void 0===a||a.setActive(t.AnimationType.Drag,!0)}},onMove:function(t,n){var o,e,r,a,s=i.props,u=s.dragPropagation,l=s.dragDirectionLock;if(u||i.openGlobalLock){var c=n.offset;if(l&&null===i.currentDirection)return i.currentDirection=function(t,n){void 0===n&&(n=10);var o=null;Math.abs(t.y)>n?o="y":Math.abs(t.x)>n&&(o="x");return o}(c),void(null!==i.currentDirection&&(null===(e=(o=i.props).onDirectionLock)||void 0===e||e.call(o,i.currentDirection)));i.updateAxis("x",t,c),i.updateAxis("y",t,c),null===(a=(r=i.props).onDrag)||void 0===a||a.call(r,t,n),R=t}},onEnd:function(t,n){return i.stop(t,n)}},{transformPagePoint:u})},n.prototype.prepareBoundingBox=function(){var t=this.visualElement;t.withoutTransform((function(){t.updateLayoutMeasurement()})),t.rebaseProjectionTarget(!0,t.measureViewportBox(!1))},n.prototype.resolveDragConstraints=function(){var n=this,o=this.props,i=o.dragConstraints,e=o.dragElastic;this.constraints=!!i&&(t.isRefObject(i)?this.resolveRefConstraints(this.visualElement.getLayoutState().layout,i):function(t,n){var o=n.top,i=n.left,e=n.bottom,r=n.right;return{x:_(t.x,i,r),y:_(t.y,o,e)}}(this.visualElement.getLayoutState().layout,i)),this.elastic=function(t){return!1===t?t=0:!0===t&&(t=.35),{x:B(t,"left","right"),y:B(t,"top","bottom")}}(e),this.constraints&&!this.hasMutatedConstraints&&t.eachAxis((function(t){var o,i,e;n.getAxisMotionValue(t)&&(n.constraints[t]=(o=n.visualElement.getLayoutState().layout[t],i=n.constraints[t],e={},void 0!==i.min&&(e.min=i.min-o.min),void 0!==i.max&&(e.max=i.max-o.min),e))}))},n.prototype.resolveRefConstraints=function(n,o){var i=this.props,e=i.onMeasureDragConstraints,r=i.transformPagePoint,a=o.current;t.invariant(null!==a,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop."),this.constraintsBox=t.getBoundingBox(a,r);var s=function(t,n){return{x:b(t.x,n.x),y:b(t.y,n.y)}}(n,this.constraintsBox);if(e){var u=e(t.convertAxisBoxToBoundingBox(s));this.hasMutatedConstraints=!!u,u&&(s=t.convertBoundingBoxToAxisBox(u))}return s},n.prototype.cancelDrag=function(){var n;this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),null===(n=this.visualElement.animationState)||void 0===n||n.setActive(t.AnimationType.Drag,!1)},n.prototype.stop=function(t,n){var o;this.visualElement.unlockProjectionTarget(),null===(o=this.panSession)||void 0===o||o.end(),this.panSession=null;var i=this.isDragging;if(this.cancelDrag(),i){var e=this.props,r=e.dragMomentum,a=e.onDragEnd;if(r||this.elastic){var s=n.velocity;this.animateDragEnd(s)}null==a||a(t,n)}},n.prototype.snapToCursor=function(n){var o=this;this.prepareBoundingBox(),t.eachAxis((function(t){if(U(t,o.props.drag,o.currentDirection)){var i=o.getAxisMotionValue(t);if(i){var e=c(n).point,r=o.visualElement.getLayoutState().layout,a=r[t].max-r[t].min,s=r[t].min+a/2,u=e[t]-s;o.originPoint[t]=e[t],i.set(u)}else o.cursorProgress[t]=.5,o.updateVisualElementAxis(t,n)}}))},n.prototype.updateAxis=function(t,n,o){if(U(t,this.props.drag,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,o):this.updateVisualElementAxis(t,n)},n.prototype.updateAxisMotionValue=function(t,n){var o=this.getAxisMotionValue(t);if(n&&o){var i=this.originPoint[t]+n[t],e=this.constraints?L(i,this.constraints[t],this.elastic[t]):i;o.set(e)}},n.prototype.updateVisualElementAxis=function(t,n){var o,i=this.visualElement.getLayoutState().layout[t],e=i.max-i.min,r=this.cursorProgress[t],a=function(t,n,o,i,e){var r=t-n*o;return i?L(r,i,e):r}(c(n).point[t],e,r,null===(o=this.constraints)||void 0===o?void 0:o[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,a,a+e)},n.prototype.setProps=function(n){var o=n.drag,i=void 0!==o&&o,e=n.dragDirectionLock,r=void 0!==e&&e,a=n.dragPropagation,s=void 0!==a&&a,u=n.dragConstraints,l=void 0!==u&&u,c=n.dragElastic,p=void 0===c?.35:c,v=n.dragMomentum,m=void 0===v||v,f=t.__rest(n,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=t.__assign({drag:i,dragDirectionLock:r,dragPropagation:s,dragConstraints:l,dragElastic:p,dragMomentum:m},f)},n.prototype.getAxisMotionValue=function(t){var n=this.props,o=n.layout,i=n.layoutId,e="_drag"+t.toUpperCase();return this.props[e]?this.props[e]:o||void 0!==i?void 0:this.visualElement.getValue(t,0)},n.prototype.animateDragEnd=function(n){var o=this,i=this.props,e=i.drag,r=i.dragMomentum,a=i.dragElastic,s=i.dragTransition,u=t.eachAxis((function(i){if(U(i,e,o.currentDirection)){var u=o.constraints?o.constraints[i]:{},l=a?200:1e6,c=a?40:1e7,p=t.__assign(t.__assign({type:"inertia",velocity:r?n[i]:0,bounceStiffness:l,bounceDamping:c,timeConstant:750,restDelta:1,restSpeed:10},s),u);return o.getAxisMotionValue(i)?o.startAxisValueAnimation(i,p):o.visualElement.startLayoutAnimation(i,p)}}));return Promise.all(u).then((function(){var t,n;null===(n=(t=o.props).onDragTransitionEnd)||void 0===n||n.call(t)}))},n.prototype.stopMotion=function(){var n=this;t.eachAxis((function(t){var o=n.getAxisMotionValue(t);o?o.stop():n.visualElement.stopLayoutAnimation()}))},n.prototype.startAxisValueAnimation=function(n,o){var i=this.getAxisMotionValue(n);if(i){var e=i.get();return i.set(e),i.set(e),t.startAnimation(n,i,0,o)}},n.prototype.scalePoint=function(){var n=this,o=this.props,i=o.drag,e=o.dragConstraints;if(t.isRefObject(e)&&this.constraintsBox){this.stopMotion();var r={x:0,y:0};t.eachAxis((function(o){r[o]=t.calcOrigin(n.visualElement.projection.target[o],n.constraintsBox[o])})),this.prepareBoundingBox(),this.resolveDragConstraints(),t.eachAxis((function(o){if(U(o,i,null)){var e=function(n,o,i){var e=n.max-n.min,r=t.mix(o.min,o.max-e,i);return{min:r,max:r+e}}(n.visualElement.projection.target[o],n.constraintsBox[o],r[o]),a=e.min,s=e.max;n.visualElement.setProjectionTargetAxis(o,a,s)}}))}},n.prototype.mount=function(t){var n=this,i=g(t.getInstance(),"pointerdown",(function(t){var o=n.props,i=o.drag,e=o.dragListener;i&&(void 0===e||e)&&n.start(t)})),e=o(window,"resize",(function(){n.scalePoint()})),r=t.onLayoutUpdate((function(){n.isDragging&&n.resolveDragConstraints()})),a=t.prevDragCursor;return a&&this.start(R,{cursorProgress:a}),function(){null==i||i(),null==e||e(),null==r||r(),n.cancelDrag()}},n}();function U(t,n,o){return!(!0!==n&&n!==t||null!==o&&o!==t)}var G=t.makeRenderlessComponent((function(o){var i=o.visualElement;return function(o,i){var e=o.dragControls,r=n.useContext(t.MotionConfigContext).transformPagePoint,a=t.useConstant((function(){return new j({visualElement:i})}));a.setProps(t.__assign(t.__assign({},o),{transformPagePoint:r})),n.useEffect((function(){return e&&e.subscribe(a)}),[a]),n.useEffect((function(){return a.mount(i)}),[])}(t.__rest(o,["visualElement"]),i)})),I={key:"drag",shouldRender:function(t){return!!t.drag||!!t.dragControls},getComponent:function(){return G}};var H=function(t,n){return!!n&&(t===n||H(t,n.parentElement))};function F(o,i){var e=o.onTap,r=o.onTapStart,a=o.onTapCancel,s=o.whileTap,u=e||r||a||s,l=n.useRef(!1),c=n.useRef(null);function p(){var t;null===(t=c.current)||void 0===t||t.call(c),c.current=null}function v(){var n,o;return p(),l.current=!1,null===(n=i.animationState)||void 0===n||n.setActive(t.AnimationType.Tap,!1),!(!(o=S(!0))||(o(),0))}function m(t,n){v()&&(H(i.getInstance(),t.target)?null==e||e(t,n):null==a||a(t,n))}function f(t,n){v()&&(null==a||a(t,n))}h(i,"pointerdown",u?function(n,o){var e;p(),l.current||(l.current=!0,c.current=t.pipe(g(window,"pointerup",m),g(window,"pointercancel",f)),null==r||r(n,o),null===(e=i.animationState)||void 0===e||e.setActive(t.AnimationType.Tap,!0))}:void 0),t.useUnmountEffect(p)}function O(n,o,i){return function(r,a){var s;e(r)&&n.isHoverEventsEnabled&&(null==i||i(r,a),null===(s=n.animationState)||void 0===s||s.setActive(t.AnimationType.Hover,o))}}function X(o,e){var r,a,s,u,l,c,p,v,m,f;a=e,s=(r=o).onPan,u=r.onPanStart,l=r.onPanEnd,c=r.onPanSessionStart,p=s||u||l||c,v=n.useRef(null),m=n.useContext(t.MotionConfigContext).transformPagePoint,f={onSessionStart:c,onStart:u,onMove:s,onEnd:function(t,n){v.current=null,l&&l(t,n)}},n.useEffect((function(){null!==v.current&&v.current.updateHandlers(f)})),h(a,"pointerdown",p&&function(t){v.current=new x(t,f,{transformPagePoint:m})}),t.useUnmountEffect((function(){return v.current&&v.current.end()})),F(o,e),function(t,n){var o=t.onHoverStart,i=t.onHoverEnd,e=t.whileHover;h(n,"pointerenter",o||e?O(n,!0,o):void 0),h(n,"pointerleave",i||e?O(n,!1,i):void 0)}(o,e),function(n,o){var e=n.whileFocus;i(o,"focus",e?function(){var n;null===(n=o.animationState)||void 0===n||n.setActive(t.AnimationType.Focus,!0)}:void 0),i(o,"blur",e?function(){var n;null===(n=o.animationState)||void 0===n||n.setActive(t.AnimationType.Focus,!1)}:void 0)}(o,e)}var Y=t.makeRenderlessComponent((function(n){var o=n.visualElement;X(t.__rest(n,["visualElement"]),o)})),q={key:"gestures",shouldRender:function(n){return t.gestureProps.some((function(t){return n.hasOwnProperty(t)}))},getComponent:function(){return Y}};var z=function(n){function o(){var o=null!==n&&n.apply(this,arguments)||this;return o.frameTarget={x:{min:0,max:0},y:{min:0,max:0}},o.stopAxisAnimation={x:void 0,y:void 0},o.isAnimatingTree=!1,o.animate=function(n,i,e){void 0===e&&(e={});var r=e.originBox,a=e.targetBox,s=e.visibilityAction,u=e.shouldStackAnimate,l=e.onComplete,c=t.__rest(e,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete"]),p=o.props,v=p.visualElement,m=p.layout;if(!1===u)return o.isAnimatingTree=!1,o.safeToRemove();if(!o.isAnimatingTree||!0===u){u&&(o.isAnimatingTree=!0);var f=J(i=r||i,n=a||n),d=t.eachAxis((function(e){if("position"===m){var r=n[e].max-n[e].min;i[e].max=i[e].min+r}if(!v.projection.isTargetLocked)return void 0===s?f?o.animateAxis(e,n[e],i[e],c):v.setProjectionTargetAxis(e,n[e].min,n[e].max):void v.setVisibility(s===t.VisibilityAction.Show)}));return v.syncRender(),Promise.all(d).then((function(){o.isAnimatingTree=!1,l&&l(),v.notifyLayoutAnimationComplete()}))}},o}return t.__extends(o,n),o.prototype.componentDidMount=function(){var n=this,o=this.props.visualElement;o.animateMotionValue=t.startAnimation,o.enableLayoutProjection(),this.unsubLayoutReady=o.onLayoutUpdate(this.animate),o.layoutSafeToRemove=function(){return n.safeToRemove()}},o.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),t.eachAxis((function(t){var o,i;return null===(i=(o=n.stopAxisAnimation)[t])||void 0===i?void 0:i.call(o)}))},o.prototype.animateAxis=function(n,o,i,e){var r,a,s=(void 0===e?{}:e).transition;null===(a=(r=this.stopAxisAnimation)[n])||void 0===a||a.call(r);var u=this.props.visualElement,l=this.frameTarget[n],c=u.getProjectionAnimationProgress()[n];c.clearListeners(),c.set(0),c.set(0);var p=function(){var e=c.get()/1e3;!function(n,o,i,e){n.min=t.mix(o.min,i.min,e),n.max=t.mix(o.max,i.max,e)}(l,i,o,e),u.setProjectionTargetAxis(n,l.min,l.max)};p(),u.updateLayoutProjection();var v=c.onChange(p),m=t.startAnimation("x"===n?"layoutX":"layoutY",c,1e3,s||this.props.transition||Z).then(v);return this.stopAxisAnimation[n]=function(){c.stop(),v()},m},o.prototype.safeToRemove=function(){var t,n;null===(n=(t=this.props).safeToRemove)||void 0===n||n.call(t)},o.prototype.render=function(){return null},o}(n.Component);function W(o){var i=t.__read(t.usePresence(),2)[1];return n.createElement(z,t.__assign({},o,{safeToRemove:i}))}function J(t,n){return!(N(t)||N(n)||Q(t.x,n.x)&&Q(t.y,n.y))}var K={min:0,max:0};function N(t){return Q(t.x,K)&&Q(t.y,K)}function Q(t,n){return t.min===n.min&&t.max===n.max}var Z={duration:.45,ease:[.4,0,.1,1]},$={key:"animate-layout",shouldRender:function(t){return!!t.layout||void 0!==t.layoutId},getComponent:function(){return W}},tt=[t.MeasureLayout,t.Animation,I,q,t.Exit,$],nt=t.createMotionProxy(tt);exports.motion=nt;
//# sourceMappingURL=motion-8b04ad94.js.map
